services:
  dev-db:
    image: postgres:13
    ports:
      - '5434:5432'
    environment:
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
    networks:
      - cybus-network
    container_name: cybus-db
  test-db:
    image: postgres:13
    ports:
      - '5435:5432'
    environment:
      POSTGRES_USER: ${POSTGRES_TEST_USER}
      POSTGRES_PASSWORD: ${POSTGRES_TEST_PASSWORD}
      POSTGRES_DB: ${POSTGRES_TEST_DB}
    networks:
      - cybus-network
    container_name: cybus-test-db
  otp:
    # Digest corresponds to OpenTripPlanner version 2.8.0-SNAPSHOT (commit 27cb855..., build 2025-07-27)
    image: docker.io/opentripplanner/opentripplanner@sha256:2ac19ae5746cf1962c2611823f57803d2d928dbef4b2b7ead7d485fac40c4f67
    container_name: otp
    ports:
      - "8080:8080"
    volumes:
      - ./data/otp:/var/opentripplanner
    command: --build --save --serve
    networks:
      - cybus-network

networks:
  cybus-network:
